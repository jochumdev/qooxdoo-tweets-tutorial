{
  "version": 3,
  "sources": [
    "Manager.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "statics",
    "__scheduled",
    "__canceled",
    "__jobs",
    "__retries",
    "MAX_RETRIES",
    "scheduleFlush",
    "job",
    "self",
    "ui",
    "core",
    "queue",
    "Manager",
    "bom",
    "AnimationFrame",
    "request",
    "flush",
    "__inFlush",
    "jobs",
    "__executeAndRescheduleOnError",
    "visibility",
    "widget",
    "appearance",
    "layout",
    "element",
    "Environment",
    "get",
    "Widget",
    "e",
    "log",
    "Logger",
    "error",
    "Visibility",
    "Appearance",
    "Layout",
    "html",
    "Element",
    "dispose",
    "Dispose",
    "select",
    "callback",
    "finallyCode",
    "dev",
    "StackTrace",
    "getStackTraceFromError",
    "Error",
    "__onUserAction",
    "defer",
    "_scheduleFlush",
    "event",
    "Registration",
    "addListener",
    "window"
  ],
  "mappings": "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",
  "file": "Manager.js",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Fabian Jakobs (fjakobs)\n\n************************************************************************ */\n\n/**\n * This class performs the auto flush of all layout relevant queues.\n *\n * @require(qx.event.handler.UserAction)\n */\nqx.Class.define(\"qx.ui.core.queue.Manager\",\n{\n  statics :\n  {\n    /** @type {Boolean} Whether a flush was scheduled */\n    __scheduled : false,\n\n    /** @type {Boolean} true, if the flush should not be executed */\n    __canceled : false,\n\n    /** @type {Map} Internal data structure for the current job list */\n    __jobs : {},\n\n\n    /** @type {Integer} Counts how often a flush failed due to exceptions */\n    __retries : 0,\n\n    /** @type {Integer} Maximum number of flush retries */\n    MAX_RETRIES : 10,\n\n\n    /**\n     * Schedule a deferred flush of all queues.\n     *\n     * @param job {String} The job, which should be performed. Valid values are\n     *     <code>layout</code>, <code>decoration</code> and <code>element</code>.\n     */\n    scheduleFlush : function(job)\n    {\n      // Sometimes not executed in context, fix this\n      var self = qx.ui.core.queue.Manager;\n\n      self.__jobs[job] = true;\n\n      if (!self.__scheduled)\n      {\n        self.__canceled = false;\n\n        qx.bom.AnimationFrame.request(function() {\n          if (self.__canceled) {\n            self.__canceled = false;\n            return;\n          }\n          self.flush();\n        }, self);\n        self.__scheduled = true;\n      }\n    },\n\n\n    /**\n     * Flush all layout queues in the correct order. This function is called\n     * deferred if {@link #scheduleFlush} is called.\n     *\n     */\n    flush : function()\n    {\n      // Sometimes not executed in context, fix this\n      var self = qx.ui.core.queue.Manager;\n\n      // Stop when already executed\n      if (self.__inFlush) {\n        return;\n      }\n\n      self.__inFlush = true;\n\n      // Cancel timeout if called manually\n      self.__canceled = true;\n\n      var jobs = self.__jobs;\n\n      self.__executeAndRescheduleOnError(function()\n      {\n        // Process jobs\n        while (jobs.visibility || jobs.widget || jobs.appearance || jobs.layout || jobs.element)\n        {\n          // No else blocks here because each flush can influence the following flushes!\n          if (jobs.widget)\n          {\n            delete jobs.widget;\n\n            if (qx.core.Environment.get(\"qx.debug.ui.queue\")) {\n              try {\n                qx.ui.core.queue.Widget.flush();\n              } catch (e) {\n                qx.log.Logger.error(qx.ui.core.queue.Widget, \"Error in the 'Widget' queue:\" + e, e);\n              }\n            } else {\n              qx.ui.core.queue.Widget.flush();\n            }\n          }\n\n          if (jobs.visibility)\n          {\n            delete jobs.visibility;\n\n            if (qx.core.Environment.get(\"qx.debug.ui.queue\")) {\n              try {\n                qx.ui.core.queue.Visibility.flush();\n              } catch (e) {\n                qx.log.Logger.error(qx.ui.core.queue.Visibility, \"Error in the 'Visibility' queue:\" + e, e);\n              }\n            } else {\n              qx.ui.core.queue.Visibility.flush();\n            }\n          }\n\n          if (jobs.appearance)\n          {\n            delete jobs.appearance;\n\n            if (qx.core.Environment.get(\"qx.debug.ui.queue\")) {\n              try {\n                qx.ui.core.queue.Appearance.flush();\n              } catch (e) {\n                qx.log.Logger.error(qx.ui.core.queue.Appearance, \"Error in the 'Appearance' queue:\" + e, e);\n              }\n            } else {\n              qx.ui.core.queue.Appearance.flush();\n            }\n          }\n\n          // Defer layout as long as possible\n          if (jobs.widget || jobs.visibility || jobs.appearance) {\n            continue;\n          }\n\n          if (jobs.layout)\n          {\n            delete jobs.layout;\n\n            if (qx.core.Environment.get(\"qx.debug.ui.queue\")) {\n              try {\n                qx.ui.core.queue.Layout.flush();\n              } catch (e) {\n                qx.log.Logger.error(qx.ui.core.queue.Layout, \"Error in the 'Layout' queue:\" + e, e);\n              }\n            } else {\n              qx.ui.core.queue.Layout.flush();\n            }\n          }\n\n          // Defer element as long as possible\n          if (jobs.widget || jobs.visibility || jobs.appearance || jobs.layout) {\n            continue;\n          }\n\n          if (jobs.element)\n          {\n            delete jobs.element;\n            qx.html.Element.flush();\n          }\n        }\n      }, function() {\n        self.__scheduled = false;\n      });\n\n      self.__executeAndRescheduleOnError(function()\n      {\n        if (jobs.dispose)\n        {\n          delete jobs.dispose;\n\n          if (qx.core.Environment.get(\"qx.debug.ui.queue\")) {\n            try {\n              qx.ui.core.queue.Dispose.flush();\n            } catch (e) {\n              qx.log.Logger.error(\"Error in the 'Dispose' queue:\" + e);\n            }\n          } else {\n            qx.ui.core.queue.Dispose.flush();\n          }\n        }\n      }, function() {\n        // Clear flag\n        self.__inFlush = false;\n      });\n\n      // flush succeeded successfully. Reset retries\n      self.__retries = 0;\n    },\n\n\n    /**\n     * Executes the callback code. If the callback throws an error the current\n     * flush is cleaned up and rescheduled. The finally code is called after the\n     * callback even if it has thrown an exception.\n     *\n     * @signature function(callback, finallyCode)\n     * @param callback {Function} the callback function\n     * @param finallyCode {Function} function to be called in the finally block\n     */\n    __executeAndRescheduleOnError : qx.core.Environment.select(\"qx.debug\",\n    {\n      \"true\" : function(callback, finallyCode)\n      {\n        callback();\n        finallyCode();\n      },\n\n\n      \"false\" : function(callback, finallyCode)\n      {\n        var self = qx.ui.core.queue.Manager;\n\n        try\n        {\n          callback();\n        }\n        catch (e)\n        {\n          if (qx.core.Environment.get(\"qx.debug\")) {\n            qx.log.Logger.error(\n              \"Error while layout flush: \" + e + \"\\n\" +\n              \"Stack trace: \\n\" +\n              qx.dev.StackTrace.getStackTraceFromError(e)\n            );\n          }\n          self.__scheduled = false;\n          self.__inFlush = false;\n          self.__retries += 1;\n\n          if (self.__retries <= self.MAX_RETRIES) {\n            self.scheduleFlush();\n          } else {\n            throw new Error(\n              \"Fatal Error: Flush terminated \" + (self.__retries-1) + \" times in a row\" +\n              \" due to exceptions in user code. The application has to be reloaded!\"\n            );\n          }\n\n          throw e;\n        }\n        finally\n        {\n          finallyCode();\n        }\n      }\n    }),\n\n\n    /**\n     * Handler used on touch devices to prevent the queue from manipulating\n     * the dom during the touch - mouse - ... event sequence. Usually, iOS\n     * devices fire a click event 300ms after the touchend event. So using\n     * 500ms should be a good value to be on the save side. This is necessary\n     * due to the fact that the event chain is stopped if a manipulation in\n     * the DOM is done.\n     *\n     * @param e {qx.event.type.Data} The user action data event.\n     */\n    __onUserAction : function(e)\n    {\n      qx.ui.core.queue.Manager.flush();\n    }\n  },\n\n\n\n\n  /*\n  *****************************************************************************\n     DESTRUCT\n  *****************************************************************************\n  */\n\n  defer : function(statics)\n  {\n    // Replace default scheduler for HTML element with local one.\n    // This is quite a hack, but allows us to force other flushes\n    // before the HTML element flush.\n    qx.html.Element._scheduleFlush = statics.scheduleFlush;\n\n    // Register to user action\n    qx.event.Registration.addListener(window, \"useraction\",\n      qx.core.Environment.get(\"event.touch\") ?\n        statics.__onUserAction : statics.flush\n    );\n  }\n});\n"
  ]
}